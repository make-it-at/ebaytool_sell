# eBay出品作業効率化ツール

Google Apps Script（GAS）を使用したスプレッドシートベースのeBay出品作業効率化ツールです。商品データのフィルタリングとeBay形式への変換を自動化します。

## 機能概要

- CSVインポート/エクスポート機能
- NGワードフィルタリング
- 重複チェック・削除
- 文字数制限フィルタリング
- 所在地情報修正
- 価格フィルタリング
- カスタムUI（サイドバー、ダイアログ）
- 処理ログ記録

## シート構成

- **データインポート**: リサーチツールからインポートしたデータを表示
- **処理結果**: 各種フィルター処理後のデータを表示
- **エクスポート**: eBayアップロード用に整形されたデータ
- **設定**: NGワードリスト、所在地置換パターン、各種閾値設定など
- **ログ**: 処理ログの記録

## 開発環境のセットアップ

### 前提条件

- Node.js と npm がインストール済み
- Google アカウント

### インストール手順

1. clasp のインストール
   ```
   npm install -g @google/clasp
   ```

2. Google アカウントで認証
   ```
   clasp login
   ```

3. プロジェクトのクローン
   ```
   clasp clone 1t6syXBcDCXv0H-pmS_RjICrpH4XTZAc3BsRWEP98RSq0pNfhs_jnVZEL
   ```

4. コードの編集後、アップロード
   ```
   clasp push
   ```

## 使用方法

1. スプレッドシートを開く
2. 表示されるサイドバーから操作を行う
   - CSVインポート: リサーチデータをインポート
   - フィルター処理: 各種フィルターを適用
   - CSVエクスポート: eBay形式でエクスポート

## カスタマイズ

- **設定シート**で閾値やパターンを変更
  - NGワードリスト
  - 文字数制限（デフォルト20文字）
  - 価格下限（デフォルト10ドル）
  - 重複類似度閾値（デフォルト80%）
  - 所在地置換パターン

## 技術仕様

- 言語: Google Apps Script (JavaScript)
- 最大処理行数: 10,000行
- UI: HTML, CSS, JavaScript
- データフロー: インポート → 処理 → エクスポート

## ファイル構成

- `App.gs`: メインスクリプトファイル
- `Config.gs`: 設定用モジュール
- `Filters.gs`: フィルター処理用モジュール
- `ImportExport.gs`: インポート/エクスポート用モジュール
- `UI.gs`: UI操作用モジュール
- `Logger.gs`: ログ処理用モジュール
- `*.html`: UIの各種ページ

## バージョン情報

- バージョン: 1.0.9
- 最終更新日: 2023年12月

## 変更履歴

### 1.0.9
- 設定シートのレイアウトを一般的なスプレッドシート型に変更
- NGワードリストをカンマ区切りテキストからA列の個別セルでの管理に変更
- 設定項目を横並びのテーブル形式に変更し視認性を向上
- 各セクションを分かりやすく区切り、ヘッダーの背景色を追加

### 1.0.8
- NGワード管理機能をサイドバーのテーブルから設定シート上での直接編集方式に変更
- 設定シートのレイアウトを改善（ヘッダー追加、説明列追加）
- 設定シートにNGワードの詳細な説明と使用方法を追加
- サイドバーから設定シートのNGワード設定を直接開ける機能を追加

### 1.0.7
- サイドバーのバージョン表示を更新（1.0.6 → 1.0.7）
- サイドバーにCSVファイル選択とインポート機能を直接追加
- ダイアログを開かなくてもサイドバー上でファイルをインポート可能に改善

### 1.0.6
- CSVインポート処理を改善し、加工やマッピングなしでデータをそのまま忠実にインポートするように変更
- ヘッダー行のマッピング処理を省略し、CSVファイルの内容をそのまま表示するよう修正

### 1.0.5
- 日本語などのUnicode文字を含むCSVファイルのエンコード処理に対応
- Base64エンコード/デコード処理を改善し、非ASCII文字も正しく処理できるように修正

### 1.0.4
- CSVインポート処理でUtilitiesオブジェクトをクライアント側で参照できない問題を修正
- Base64エンコードをクライアント側で行うように変更
- ImportExport.importCsv関数を直接呼び出せるようにグローバル関数importCsvFromBase64を追加
- ファイル処理時のエラーハンドリングを強化

### 1.0.3
- UI名前空間が認識されない問題を修正（グローバル関数としてUIメソッドをエクスポート）
- サイドバーからUI.showImportDialogなどの関数を直接呼び出せるよう修正

### 1.0.2
- サイドバーのスタイルが適用されない問題を修正（外部スタイルシート参照からインラインスタイルに変更）
- Font Awesomeアイコンを直接CDNから読み込むように変更

### 1.0.1
- サイドバー内のボタン操作が機能しない問題を修正（onclick属性をeventListener方式に変更）
- HTML/CSSのリンター警告を修正
- 「sidebar」ファイル参照の大文字小文字の問題を修正（sidebar→Sidebar）

### 1.0.0
- 初回リリース 